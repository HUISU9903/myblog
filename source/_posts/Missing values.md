---
title: "결측치와 이상치"
excerpt: "결측치와 이상치를 정리하는 방법을 알아본다. "
categories:

- R
tags:
- [R Study]
date: 2022-03-15 14:00:00

---
# 결측치

데이터가 없는 경우를 결측치 또는 결측값이라고 한다.

결측치를 처리할 때 우선 고려해야 하는 점은 전체 데이터에 있는 결측치의 비율이다.
결측치가 지나치게 많으면 분석해서는 안되지만, 적을 경우에는 제외하고 분석할 수 있다.

결측치를 제외하기에는 너무 많다고 판단 될 경우에는 다른 값으로 대체하고 분석하면 된다.(ex 평균값, 최빈값, 인근값)

## 결측치를 확인하고 빈도를 구하는 방법

```r
is.na(데이터세트 or 변수) # TRUE 결측치 , FALSE 결측치 아님
table(is.na(데이터세트)) # 데이터세트의 결측치 전체 빈도 구하기
table(is.na(데이터세트$변수)) # 데이터세트의 특정 변수에 있는 결측치 빈도 구하기
summary(is.na(데이터세트)) # 데이터세트의 모든 변수별로 결측치 빈도 구하기
```

## 결측치의 처리 방법

### 결측치를 제외하고 분석하기
```r
na.rm = T  # 연산함수에서 결측치를 제외
na.omit() # 결측치가 있는 행을 모두 제외하기
filter(!is.na()) # 결측치가 없는 행만 추출
```
### 결측치를 다른 값으로 대체하기

대체값으로는 평균값이 많이 쓰이지만 특정 값이 빈도가 많을 때는 최빈값으로 대체하기도 한다.

```r
ifelse(is.na(변수), 대체값, 변수) 
# 변수에 있는 행의 값이 NA이면 대체값을 입력하고 NA가 아니면 그대로 둔다.
```



# 이상치

이상치는 비정상적인 데이터로 이상값이라고도 한다. 두 가지 종류가 있다.

첫째는 정해진 범주에서 벗어난 데이터로 1번과 2번을 고르는 문제에서 3번을 고른 경우 등이 있다.

둘째는 범위가 정해지지는 않았지만 다른 값들에 비해 특이하게 많거나 적은 데이터이다. 
이를 극단치(아웃라이어)라고 부른다. 97%가 10~20일때 3%가 200이라면 3%를 극단치라고 본다.

## 이상치의 처리

```r
table() 이상치 확인 -> ifelse()로 이상치를 결측치로 변환 -> 결측치 제거 후 분석
```

예시를 하나 들어보자.

```r
mpg1_out <- read.csv("mpg1_out.csv")

table(mpg1_out$trans)# 3이 4개 있음
1    2    3
154  76   4

mpg1_out$trans <-ifelse(mpg1_out$trans == 3,NA,mpg1_out$trans) # 3을 결측치 처리

table(is.na(mpg1_out$trans)) # 결측치 숫자 확인
FALSE TRUE  # 3이 결측치 처리되어서 4개의 결측치 확인
 230    4 
```

위의 과정을 통해 이상치를 결측치로 변환 시킨뒤에 결측치를 다시 제외하거나,  
평균값 등으로 변환하는 과정을 거치면 된다.

## 극단치의 처리

극단치를 제거할 때는 통계적으로 극단치의 경계값을 구해서 한다.
R에서 극단치의 분포 여부와 경계값은 boxplot() 함수가 그리는 boxplot 그래프로 알 수 있다.

![image](https://user-images.githubusercontent.com/65166786/159109379-7233a4d6-e7c0-4c83-a6fd-6c61d632531a.png)

하지만 극단치의 제거를 위해서는 하위 경계값과 상위 경계값을 알아야 하는데 boxplot()는 통계값을 제공하지는 않는다.

통계값은 **boxplot()$stats**로 알 수 있다. 

```r
boxplot(데이터세트$변수)$stats # 1개 변수의 통계값
boxplot(데이터세트$변수1, 데이터세트$변수2, ...)$stats # 복수 변수의 통계값
boxplot(데이터세트$종속변수 ~ 데이터세트$범주변수, ...)$stats # 변수의 범주별 통계값
```

```r
boxplot(데이터세트$변수)$stats
    [,1]
[1,]   9
[2,]  14
[3,]  17
[4,]  19
[5,]  26
```
통계값의 결과는 행렬구조로 출력된다.
[1,]부터 [5,]까지 순서대로 하위 경계값, 1사분위수, 2사분위수, 3사분위수, 상위경계값이다.
